<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Proxy &amp; Air-Gapped Environments &mdash; NVIDIA Network Operator v25.04.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/omni-style.css" type="text/css" />
      <link rel="stylesheet" href="../_static/api-styles.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/mermaid-init.js"></script>
        <script src="../_static/design-tabs.js"></script>
        <script src="../_static/version.js"></script>
        <script src="../_static/social-media.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="NVIDIA DOCA Driver Container" href="doca-drivers.html" />
    <link rel="prev" title="Advanced Configurations" href="advanced.html" />
 


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >


<a href="../index.html">
  <img src="../_static/nvidia-logo-white.png" class="logo" alt="Logo"/>
</a>

<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">NVIDIA Network Operator</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../release-notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../platform-support.html">Platform Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started-kubernetes.html">Getting Started with Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started-openshift.html">Getting Started with Red Hat OpenShift</a></li>
<li class="toctree-l1"><a class="reference internal" href="../customizations/customization.html">Customization Options and CRDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../life-cycle-management.html">Life Cycle Management</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="advanced.html">Advanced Configurations</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Proxy &amp; Air-gapped</a></li>
<li class="toctree-l2"><a class="reference internal" href="doca-drivers.html">DOCA Driver Container</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced-configurations.html">Other Advanced Configurations</a></li>
<li class="toctree-l2"><a class="reference internal" href="images-sha256.html">Container Images Digests</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NVIDIA Network Operator</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">


<li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
  
    <li><a href="advanced.html">Advanced Configurations</a> &raquo;</li>
<li>Proxy &amp; Air-Gapped Environments</li>

      <li class="wy-breadcrumbs-aside">
      </li>
<li class="wy-breadcrumbs-aside">

  <span>&nbsp;</span>
</li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="proxy-air-gapped-environments">
<h1>Proxy &amp; Air-Gapped Environments<a class="headerlink" href="#proxy-air-gapped-environments" title="Permalink to this headline"></a></h1>
<div class="contents local topic" id="on-this-page">
<p class="topic-title">On this page</p>
<ul class="simple">
<li><p><a class="reference internal" href="#network-operator-deployment-in-a-proxy-environment" id="id1">Network Operator Deployment in a Proxy Environment</a></p>
<ul>
<li><p><a class="reference internal" href="#prerequisites" id="id2">Prerequisites</a></p></li>
<li><p><a class="reference internal" href="#http-proxy-configuration-for-openshift" id="id3">HTTP Proxy Configuration for Openshift</a></p></li>
<li><p><a class="reference internal" href="#http-proxy-configuration" id="id4">HTTP Proxy Configuration</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#network-operator-deployment-in-an-air-gapped-environment" id="id5">Network Operator Deployment in an Air-gapped Environment</a></p>
<ul>
<li><p><a class="reference internal" href="#local-image-registry" id="id6">Local Image Registry</a></p></li>
<li><p><a class="reference internal" href="#pulling-and-pushing-container-images-to-a-local-registry" id="id7">Pulling and Pushing Container Images to a Local Registry</a></p></li>
<li><p><a class="reference internal" href="#configuring-local-registry-tls-cert" id="id8">Configuring Local Registry TLS Cert</a></p></li>
<li><p><a class="reference internal" href="#local-package-repository" id="id9">Local Package Repository</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="network-operator-deployment-in-a-proxy-environment">
<h2>Network Operator Deployment in a Proxy Environment<a class="headerlink" href="#network-operator-deployment-in-a-proxy-environment" title="Permalink to this headline"></a></h2>
<p>This section describes how to successfully deploy the Network Operator in clusters behind an HTTP Proxy. By default, the Network Operator requires internet access for the following reasons:</p>
<blockquote>
<div><ul class="simple">
<li><p>Container images must be pulled during the NVIDIA Network Operator installation.</p></li>
<li><p>The driver container must download several OS packages prior to the driver installation.</p></li>
</ul>
</div></blockquote>
<p>To address these requirements, all Kubernetes nodes, as well as the driver container, must be properly configured in order to direct traffic through the proxy.</p>
<p>This section demonstrates how to configure the NVIDIA Network Operator, so that the driver container could successfully download packages behind an HTTP proxy. Since configuring Kubernetes/container runtime components for proxy use is not specific to the Network Operator, those instructions are not detailed here.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you are not running OpenShift, please skip the section titled HTTP Proxy Configuration for OpenShift, as Openshift configuration instructions are different.</p>
</div>
<section id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline"></a></h3>
<p>Kubernetes cluster is configured with HTTP proxy settings (container runtime should be enabled with HTTP proxy).</p>
</section>
<section id="http-proxy-configuration-for-openshift">
<h3>HTTP Proxy Configuration for Openshift<a class="headerlink" href="#http-proxy-configuration-for-openshift" title="Permalink to this headline"></a></h3>
<p>For Openshift, it is recommended to use the cluster-wide Proxy object to provide proxy information for the cluster.
Please follow the procedure described in <a class="reference external" href="https://docs.openshift.com/container-platform/latest/networking/enable-cluster-wide-proxy.html">Configuring the Cluster-wide Proxy</a> via the Red Hat Openshift public documentation. The NVIDIA Network Operator will automatically inject proxy related ENV into the driver container, based on the information present in the cluster-wide Proxy object.</p>
</section>
<section id="http-proxy-configuration">
<h3>HTTP Proxy Configuration<a class="headerlink" href="#http-proxy-configuration" title="Permalink to this headline"></a></h3>
<p>Specify the <code class="docutils literal notranslate"><span class="pre">ofedDriver.env</span></code> in your <code class="docutils literal notranslate"><span class="pre">values.yaml</span></code> file with appropriate <code class="docutils literal notranslate"><span class="pre">HTTP_PROXY</span></code>, <code class="docutils literal notranslate"><span class="pre">HTTPS_PROXY</span></code>, and <code class="docutils literal notranslate"><span class="pre">NO_PROXY</span></code> environment variables (in both uppercase and lowercase).</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ofedDriver</span><span class="p">:</span><span class="w"></span>
<span class="w">   </span><span class="nt">env</span><span class="p">:</span><span class="w"></span>
<span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HTTPS_PROXY</span><span class="w"></span>
<span class="w">     </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://&lt;example.proxy.com:port&gt;</span><span class="w"></span>
<span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HTTP_PROXY</span><span class="w"></span>
<span class="w">     </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://&lt;example.proxy.com:port&gt;</span><span class="w"></span>
<span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NO_PROXY</span><span class="w"></span>
<span class="w">     </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;example.com&gt;</span><span class="w"></span>
<span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https_proxy</span><span class="w"></span>
<span class="w">     </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://&lt;example.proxy.com:port&gt;</span><span class="w"></span>
<span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http_proxy</span><span class="w"></span>
<span class="w">     </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://&lt;example.proxy.com:port&gt;</span><span class="w"></span>
<span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no_proxy</span><span class="w"></span>
<span class="w">     </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;example.com&gt;</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="network-operator-deployment-in-an-air-gapped-environment">
<h2>Network Operator Deployment in an Air-gapped Environment<a class="headerlink" href="#network-operator-deployment-in-an-air-gapped-environment" title="Permalink to this headline"></a></h2>
<p>This section describes how to successfully deploy the Network Operator in clusters with restricted internet access.
By default, the Network Operator requires internet access for the following reasons:</p>
<blockquote>
<div><ul class="simple">
<li><p>The container images must be pulled during the Network Operator installation.</p></li>
<li><p>The DOCA Driver container must download several OS packages prior to the driver installation.</p></li>
</ul>
</div></blockquote>
<p>To address these requirements, it may be necessary to create a local image registry and/or a local package repository, so that the necessary images and packages will be available for your cluster.
Subsequent sections of this document detail how to configure the Network Operator to use local image registries and local package repositories.
If your cluster is behind a proxy, follow the steps listed in Network Operator Deployment in Proxy Environments.</p>
<section id="local-image-registry">
<h3>Local Image Registry<a class="headerlink" href="#local-image-registry" title="Permalink to this headline"></a></h3>
<p>Without internet access, the Network Operator requires all images to be hosted in a local image registry that is accessible to all nodes in the cluster.
To allow Network Operator to work with a local registry, users can specify local repository, image, tag along with pull secrets in the <code class="docutils literal notranslate"><span class="pre">values.yaml</span></code> file.</p>
</section>
<section id="pulling-and-pushing-container-images-to-a-local-registry">
<h3>Pulling and Pushing Container Images to a Local Registry<a class="headerlink" href="#pulling-and-pushing-container-images-to-a-local-registry" title="Permalink to this headline"></a></h3>
<p>To pull the correct images from the NVIDIA registry, you can leverage the fields <code class="docutils literal notranslate"><span class="pre">repository</span></code>, <code class="docutils literal notranslate"><span class="pre">image</span></code> and <code class="docutils literal notranslate"><span class="pre">version</span></code> specified in the <code class="docutils literal notranslate"><span class="pre">values.yaml</span></code> file or in the <a class="reference internal" href="images-sha256.html#container-images-digest"><span class="std std-ref">NVIDIA Network Operator Container Images</span></a> section.</p>
<p>NicClusterPolicy supports use of image container digest in the <cite>version</cite> field, except for DOCA driver.</p>
<p>There is one caveat with regards to the DOCA driver image. The version field must be appended by the OS name and Architecture running on the worker node.</p>
<p>For example for DOCA driver version 25.04-0.3.8.0-0, the tag for Ubuntu 24.04 with X86 architecture is “25.04-0.3.8.0-0-ubuntu24.04-amd64”.
Available DOCA driver image tags can be found at <a class="reference external" href="https://catalog.ngc.nvidia.com/orgs/nvidia/teams/mellanox/containers/doca-driver/tags">NGC</a>.</p>
<p>In case of local registry required authentication, make sure to create a pull secret and configure in NicClusterPolicy accordingly.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>NVIDIA Network Operator communicates with the Image Registry configured for the DOCA Driver in the NICClusterPolicy to list the available tags.
Specifying pull secret is required in the NicClusterPolicy DOCA Driver section, even if global container access credentials are configured on nodes.</p>
</div>
</section>
<section id="configuring-local-registry-tls-cert">
<h3>Configuring Local Registry TLS Cert<a class="headerlink" href="#configuring-local-registry-tls-cert" title="Permalink to this headline"></a></h3>
<p>NVIDIA Network Operator communicates with the Image Registry configured for the DOCA Driver in the NICClusterPolicy to list the available tags.
This is required to verify the availability of precompiled DOCA Driver container images.</p>
<p>If the Image Registry uses a TLS certificate that is not issued by a well-known Certificate Authority (CA), it is required to configure the NVIDIA Network Operator with the Certificate.</p>
<p>Fetch the TLS Certificates from the Image Registry server and save them in the <cite>ca.crt</cite> file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">REGISTRY_HOST</span><span class="o">=</span>myregistry.example.com
<span class="nb">export</span> <span class="nv">REGISTRY_PORT</span><span class="o">=</span><span class="m">5000</span>
openssl s_client -showcerts -connect <span class="si">${</span><span class="nv">REGISTRY_HOST</span><span class="si">}</span>:<span class="si">${</span><span class="nv">REGISTRY_PORT</span><span class="si">}</span> &lt;/dev/null <span class="m">2</span>&gt;/dev/null <span class="p">|</span> awk <span class="s1">&#39;/-----BEGIN CERTIFICATE-----/,/-----END CERTIFICATE-----/&#39;</span> &gt; ca.crt
</pre></div>
</div>
<p>Create a ConfigMap containing the TLS Certificates from the <cite>ca.crt file</cite>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kubectl create configmap custom-registry-cert --from-file<span class="o">=</span>&lt;external_registry&gt;<span class="o">=</span>ca.crt -n nvidia-network-operator
</pre></div>
</div>
<p>In OpenShift, update the <cite>nvidia-network-operator</cite> Subscription by adding the following <cite>config</cite> under <cite>spec</cite>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kubectl apply -f - <span class="s">&lt;&lt;EOF</span>
<span class="s">apiVersion: operators.coreos.com/v1alpha1</span>
<span class="s">kind: Subscription</span>
<span class="s">metadata:</span>
<span class="s">  name: nvidia-network-operator</span>
<span class="s">  namespace: nvidia-network-operator</span>
<span class="s">spec:</span>
<span class="s">  config:</span>
<span class="s">    volumes:</span>
<span class="s">      - configMap:</span>
<span class="s">          name: custom-registry-cert</span>
<span class="s">        name: custom-registry-ca</span>
<span class="s">    volumeMounts:</span>
<span class="s">      - mountPath: /etc/pki/tls/certs/</span>
<span class="s">        name: custom-registry-ca</span>
<span class="s">EOF</span>
</pre></div>
</div>
<p>In Kubernetes, update the <cite>network-operator</cite> Deployment’s volumes by running:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kubectl apply -f - <span class="s">&lt;&lt;EOF</span>
<span class="s">apiVersion: apps/v1</span>
<span class="s">kind: Deployment</span>
<span class="s">metadata:</span>
<span class="s">  name: network-operator</span>
<span class="s">  namespace: nvidia-network-operator</span>
<span class="s">spec:</span>
<span class="s">  template:</span>
<span class="s">    spec:</span>
<span class="s">      volumes:</span>
<span class="s">        - configMap:</span>
<span class="s">            name: custom-registry-cert</span>
<span class="s">          name: custom-registry-ca</span>
<span class="s">      containers:</span>
<span class="s">        - name: network-operator</span>
<span class="s">          volumeMounts:</span>
<span class="s">            - mountPath: /etc/pki/tls/certs/</span>
<span class="s">              name: custom-registry-ca</span>
<span class="s">EOF</span>
</pre></div>
</div>
</section>
<section id="local-package-repository">
<h3>Local Package Repository<a class="headerlink" href="#local-package-repository" title="Permalink to this headline"></a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The instructions below are provided as reference examples to set up a local package repository for NVIDIA Network Operator.</p>
</div>
<p>The DOCA Driver container deployed as part of the Network Operator requires certain packages to be available for the driver installation. In restricted internet access or air-gapped installations, users are required to create a local mirror repository for their OS distribution, and make the following packages available:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="nl">ubuntu</span><span class="p">:</span><span class="w"></span>
<span class="w">   </span><span class="n">linux</span><span class="o">-</span><span class="n">headers</span><span class="o">-</span><span class="n">$</span><span class="p">{</span><span class="n">KERNEL_VERSION</span><span class="p">}</span><span class="w"></span>
<span class="w">   </span><span class="n">linux</span><span class="o">-</span><span class="n">modules</span><span class="o">-</span><span class="n">$</span><span class="p">{</span><span class="n">KERNEL_VERSION</span><span class="p">}</span><span class="w"></span>
<span class="w">   </span><span class="n">pkg</span><span class="o">-</span><span class="n">config</span><span class="w"></span>
<span class="n">rhel</span><span class="p">,</span><span class="w"> </span><span class="n">rhcos</span><span class="o">:</span><span class="w"></span>
<span class="w">   </span><span class="n">kernel</span><span class="o">-</span><span class="n">headers</span><span class="o">-</span><span class="n">$</span><span class="p">{</span><span class="n">KERNEL_VERSION</span><span class="p">}</span><span class="w"></span>
<span class="w">   </span><span class="n">kernel</span><span class="o">-</span><span class="n">devel</span><span class="o">-</span><span class="n">$</span><span class="p">{</span><span class="n">KERNEL_VERSION</span><span class="p">}</span><span class="w"></span>
<span class="w">   </span><span class="n">kernel</span><span class="o">-</span><span class="n">core</span><span class="o">-</span><span class="n">$</span><span class="p">{</span><span class="n">KERNEL_VERSION</span><span class="p">}</span><span class="w"></span>
<span class="w">   </span><span class="n">createrepo</span><span class="w"></span>
<span class="w">   </span><span class="n">elfutils</span><span class="o">-</span><span class="n">libelf</span><span class="o">-</span><span class="n">devel</span><span class="w"></span>
<span class="w">   </span><span class="n">kernel</span><span class="o">-</span><span class="n">rpm</span><span class="o">-</span><span class="n">macros</span><span class="w"></span>
<span class="w">   </span><span class="n">umactl</span><span class="o">-</span><span class="n">libs</span><span class="w"></span>
<span class="w">   </span><span class="n">lsof</span><span class="w"></span>
<span class="w">   </span><span class="n">pm</span><span class="o">-</span><span class="n">build</span><span class="w"></span>
<span class="w">   </span><span class="n">patch</span><span class="w"></span>
<span class="w">   </span><span class="n">hostname</span><span class="w"></span>
</pre></div>
</div>
<p>For RT kernels following packages should be available:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">kernel</span><span class="o">-</span><span class="n">rt</span><span class="o">-</span><span class="n">devel</span><span class="o">-</span><span class="n">$</span><span class="p">{</span><span class="n">KERNEL_VERSION</span><span class="p">}</span><span class="w"></span>
<span class="n">kernel</span><span class="o">-</span><span class="n">rt</span><span class="o">-</span><span class="n">modules</span><span class="o">-</span><span class="n">$</span><span class="p">{</span><span class="n">KERNEL_VERSION</span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>For Ubuntu, these packages can be found at <a class="reference external" href="http://archive.ubuntu.com/">archive.ubuntu.com</a>, and be used as the mirror that must be replicated locally for your cluster. By using apt-mirror or apt-get download, you can create a full or a partial mirror to your repository server.</p>
<p>For RHCOS, dnf reposync can be used to create the local mirror. This requires an active Red Hat subscription for the supported OpenShift version. For example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dnf --releasever<span class="o">=</span><span class="m">8</span>.4 reposync --repo rhel-8-for-x86_64-appstream-rpms --download-metadata
</pre></div>
</div>
<p>Once all the above required packages are mirrored to the local repository, repo lists must be created following distribution specific documentation. A ConfigMap containing the repo list file should be created in the namespace where the NVIDIA Network Operator is deployed.</p>
<p>Following is an example of a repo list for Ubuntu 20.04 (access to a local package repository via HTTP):</p>
<p><code class="docutils literal notranslate"><span class="pre">custom-repo.list</span></code>:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">deb</span><span class="w"> </span><span class="p">[</span><span class="n">arch</span><span class="o">=</span><span class="n">amd64</span><span class="w"> </span><span class="n">trusted</span><span class="o">=</span><span class="n">yes</span><span class="p">]</span><span class="w"> </span><span class="n">http</span><span class="o">:</span><span class="c1">//&lt;local pkg repository&gt;/ubuntu/mirror/archive.ubuntu.com/ubuntu focal main universe</span>
<span class="n">deb</span><span class="w"> </span><span class="p">[</span><span class="n">arch</span><span class="o">=</span><span class="n">amd64</span><span class="w"> </span><span class="n">trusted</span><span class="o">=</span><span class="n">yes</span><span class="p">]</span><span class="w"> </span><span class="n">http</span><span class="o">:</span><span class="c1">//&lt;local pkg repository&gt;/ubuntu/mirror/archive.ubuntu.com/ubuntu focal-updates main universe</span>
<span class="n">deb</span><span class="w"> </span><span class="p">[</span><span class="n">arch</span><span class="o">=</span><span class="n">amd64</span><span class="w"> </span><span class="n">trusted</span><span class="o">=</span><span class="n">yes</span><span class="p">]</span><span class="w"> </span><span class="n">http</span><span class="o">:</span><span class="c1">//&lt;local pkg repository&gt;/ubuntu/mirror/archive.ubuntu.com/ubuntu focal-security main universe</span>
</pre></div>
</div>
<p>Following is an example of a repo list for RHCOS (access to a local package repository via HTTP):</p>
<p><code class="docutils literal notranslate"><span class="pre">cuda.repo</span></code> (a mirror of <a class="reference external" href="https://developer.download.nvidia.com/compute/cuda/repos/rhel8/x86_64">https://developer.download.nvidia.com/compute/cuda/repos/rhel8/x86_64</a>):</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">cuda</span><span class="p">]</span><span class="w"></span>
<span class="n">name</span><span class="o">=</span><span class="n">cuda</span><span class="w"></span>
<span class="n">baseurl</span><span class="o">=</span><span class="n">http</span><span class="o">:</span><span class="c1">//&lt;local pkg repository&gt;/cuda</span>
<span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="n">gpgcheck</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="n">enabled</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">redhat.repo</span></code>:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">baseos</span><span class="p">]</span><span class="w"></span>
<span class="n">name</span><span class="o">=</span><span class="n">rhel</span><span class="mi">-8</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">baseos</span><span class="o">-</span><span class="n">rpms</span><span class="w"></span>
<span class="n">baseurl</span><span class="o">=</span><span class="n">http</span><span class="o">:</span><span class="c1">//&lt;local pkg repository&gt;/rhel-8-for-x86_64-baseos-rpms</span>
<span class="n">gpgcheck</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="n">enabled</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="p">[</span><span class="n">baseoseus</span><span class="p">]</span><span class="w"></span>
<span class="n">name</span><span class="o">=</span><span class="n">rhel</span><span class="mi">-8</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">baseos</span><span class="o">-</span><span class="n">eus</span><span class="o">-</span><span class="n">rpms</span><span class="w"></span>
<span class="n">baseurl</span><span class="o">=</span><span class="n">http</span><span class="o">:</span><span class="c1">//&lt;local pkg repository&gt;/rhel-8-for-x86_64-baseos-eus-rpms</span>
<span class="n">gpgcheck</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="n">enabled</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="p">[</span><span class="n">rhocp</span><span class="p">]</span><span class="w"></span>
<span class="n">name</span><span class="o">=</span><span class="n">rhocp</span><span class="mf">-4.10</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">rhel</span><span class="mi">-8</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">rpms</span><span class="w"></span>
<span class="n">baseurl</span><span class="o">=</span><span class="n">http</span><span class="o">:</span><span class="c1">//&lt;local pkg repository&gt;/rhocp-4.10-for-rhel-8-x86_64-rpms</span>
<span class="n">gpgcheck</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="n">enabled</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="p">[</span><span class="n">apstream</span><span class="p">]</span><span class="w"></span>
<span class="n">name</span><span class="o">=</span><span class="n">rhel</span><span class="mi">-8</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">appstream</span><span class="o">-</span><span class="n">rpms</span><span class="w"></span>
<span class="n">baseurl</span><span class="o">=</span><span class="n">http</span><span class="o">:</span><span class="c1">//&lt;local pkg repository&gt;/rhel-8-for-x86_64-appstream-rpms</span>
<span class="n">gpgcheck</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="n">enabled</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ubi.repo</span></code>:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">ubi</span><span class="mi">-8</span><span class="o">-</span><span class="n">baseos</span><span class="p">]</span><span class="w"></span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Red</span><span class="w"> </span><span class="n">Hat</span><span class="w"> </span><span class="n">Universal</span><span class="w"> </span><span class="n">Base</span><span class="w"> </span><span class="n">Image</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="p">(</span><span class="n">RPMs</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">BaseOS</span><span class="w"></span>
<span class="n">baseurl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">http</span><span class="o">:</span><span class="c1">//&lt;local pkg repository&gt;/ubi-8-baseos</span>
<span class="n">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">gpgcheck</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="p">[</span><span class="n">ubi</span><span class="mi">-8</span><span class="o">-</span><span class="n">baseos</span><span class="o">-</span><span class="n">source</span><span class="p">]</span><span class="w"></span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Red</span><span class="w"> </span><span class="n">Hat</span><span class="w"> </span><span class="n">Universal</span><span class="w"> </span><span class="n">Base</span><span class="w"> </span><span class="n">Image</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="p">(</span><span class="n">Source</span><span class="w"> </span><span class="n">RPMs</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">BaseOS</span><span class="w"></span>
<span class="n">baseurl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">http</span><span class="o">:</span><span class="c1">//&lt;local pkg repository&gt;/ubi-8-baseos-source</span>
<span class="n">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="n">gpgcheck</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="p">[</span><span class="n">ubi</span><span class="mi">-8</span><span class="o">-</span><span class="n">appstream</span><span class="p">]</span><span class="w"></span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Red</span><span class="w"> </span><span class="n">Hat</span><span class="w"> </span><span class="n">Universal</span><span class="w"> </span><span class="n">Base</span><span class="w"> </span><span class="n">Image</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="p">(</span><span class="n">RPMs</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">AppStream</span><span class="w"></span>
<span class="n">baseurl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">http</span><span class="o">:</span><span class="c1">//&lt;local pkg repository&gt;/ubi-8-appstream</span>
<span class="n">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">gpgcheck</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="p">[</span><span class="n">ubi</span><span class="mi">-8</span><span class="o">-</span><span class="n">appstream</span><span class="o">-</span><span class="n">source</span><span class="p">]</span><span class="w"></span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Red</span><span class="w"> </span><span class="n">Hat</span><span class="w"> </span><span class="n">Universal</span><span class="w"> </span><span class="n">Base</span><span class="w"> </span><span class="n">Image</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="p">(</span><span class="n">Source</span><span class="w"> </span><span class="n">RPMs</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">AppStream</span><span class="w"></span>
<span class="n">baseurl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">http</span><span class="o">:</span><span class="c1">//&lt;local pkg repository&gt;/ubi-8-appstream-source</span>
<span class="n">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="n">gpgcheck</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
</pre></div>
</div>
<p>Create the ConfigMap for Ubuntu:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kubectl create configmap repo-config -n &lt;Network Operator Namespace&gt; --from-file<span class="o">=</span>&lt;path-to-repo-list-file&gt;
</pre></div>
</div>
<p>Create the ConfigMap for RHCOS:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kubectl create configmap repo-config -n &lt;Network Operator Namespace&gt; --from-file<span class="o">=</span>cuda.repo --from-file<span class="o">=</span>redhat.repo --from-file<span class="o">=</span>ubi.repo
</pre></div>
</div>
<p>Once the ConfigMap is created using the above command, update the <code class="docutils literal notranslate"><span class="pre">values.yaml</span></code> file with this information to let the Network Operator mount the repo configuration within the driver container and pull the required packages. Based on the OS distribution, the Network Operator will automatically mount this ConfigMap into the appropriate directory.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ofedDriver</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">deploy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">  </span><span class="nt">repoConfg</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">repo-config</span><span class="w"></span>
</pre></div>
</div>
<p>If self-signed certificates are used for an HTTPS based internal repository, a ConfigMap must be created for those certifications and provided during the Network Operator installation. Based on the OS distribution, the Network Operator will automatically mount this ConfigMap into the appropriate directory.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kubectl create configmap cert-config -n &lt;Network Operator Namespace&gt; --from-file<span class="o">=</span>&lt;path-to-pem-file1&gt; --from-file<span class="o">=</span>&lt;path-to-pem-file2&gt;
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ofedDriver</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">deploy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">  </span><span class="nt">certConfg</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cert-config</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, NVIDIA.
      <span class="lastupdated">Last updated on Apr 25, 2025.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 



</body>
</html>