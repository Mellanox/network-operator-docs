<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Helm Chart Customization Options &mdash; NVIDIA Network Operator v24.7.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/omni-style.css" type="text/css" />
      <link rel="stylesheet" href="../_static/api-styles.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/mermaid-init.js"></script>
        <script src="../_static/design-tabs.js"></script>
        <script src="../_static/version.js"></script>
        <script src="../_static/social-media.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Network Operator API reference v1alpha1" href="crds.html" />
    <link rel="prev" title="Customization Options" href="customization.html" />
 


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >


<a href="../index.html">
  <img src="../_static/nvidia-logo-white.png" class="logo" alt="Logo"/>
</a>

<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">NVIDIA Network Operator</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../release-notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../platform-support.html">Platform Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started-kubernetes.html">Getting Started with Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started-openshift.html">Getting Started with Red Hat OpenShift</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="customization.html">Customization Options and CRDs</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Helm Chart</a></li>
<li class="toctree-l2"><a class="reference internal" href="crds.html">CRDs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../life-cycle-management.html">Life Cycle Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced-configurations.html">Advanced Configurations</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NVIDIA Network Operator</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">


<li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
  
    <li><a href="customization.html">Customization Options</a> &raquo;</li>
<li>Helm Chart Customization Options</li>

      <li class="wy-breadcrumbs-aside">
      </li>
<li class="wy-breadcrumbs-aside">

  <span>&nbsp;</span>
</li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="helm-chart-customization-options">
<h1>Helm Chart Customization Options<a class="headerlink" href="#helm-chart-customization-options" title="Permalink to this headline"></a></h1>
<p>There are various customizations you can do to tailor the deployment of the Network Operator to your cluster needs. You
can find those below.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#general-parameters" id="id6">General Parameters</a></p>
<ul>
<li><p><a class="reference internal" href="#imagepullsecrets-customization" id="id7">ImagePullSecrets customization</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#nfd-labels" id="id8">NFD labels</a></p></li>
<li><p><a class="reference internal" href="#node-feature-discovery" id="id9">Node Feature Discovery</a></p></li>
<li><p><a class="reference internal" href="#sr-iov-network-operator" id="id10">SR-IOV Network Operator</a></p></li>
<li><p><a class="reference internal" href="#container-resources" id="id11">Container Resources</a></p></li>
<li><p><a class="reference internal" href="#nvidia-doca-driver" id="id12">NVIDIA DOCA Driver</a></p></li>
<li><p><a class="reference internal" href="#nvidia-doca-driver-driver-environment-variables" id="id13">NVIDIA DOCA Driver Driver Environment Variables</a></p></li>
<li><p><a class="reference internal" href="#rdma-shared-device-plugin" id="id14">RDMA Shared Device Plugin</a></p></li>
<li><p><a class="reference internal" href="#rdma-device-plugin-resource-configurations" id="id15">RDMA Device Plugin Resource Configurations</a></p></li>
<li><p><a class="reference internal" href="#sr-iov-network-device-plugin" id="id16">SR-IOV Network Device Plugin</a></p></li>
<li><p><a class="reference internal" href="#sr-iov-network-device-plugin-resource-configuration" id="id17">SR-IOV Network Device Plugin Resource Configuration</a></p></li>
<li><p><a class="reference internal" href="#ib-kubernetes" id="id18">IB Kubernetes</a></p></li>
<li><p><a class="reference internal" href="#ufm-secret" id="id19">UFM Secret</a></p></li>
<li><p><a class="reference internal" href="#nvidia-ipam-plugin" id="id20">NVIDIA IPAM Plugin</a></p></li>
<li><p><a class="reference internal" href="#secondary-network" id="id21">Secondary Network</a></p></li>
<li><p><a class="reference internal" href="#nvidia-nic-feature-discovery" id="id22">NVIDIA NIC Feature Discovery</a></p></li>
<li><p><a class="reference internal" href="#doca-telemetry-service" id="id23">DOCA Telemetry Service</a></p></li>
<li><p><a class="reference internal" href="#helm-customization-file" id="id24">Helm customization file</a></p></li>
</ul>
</div>
<section id="general-parameters">
<h2>General Parameters<a class="headerlink" href="#general-parameters" title="Permalink to this headline"></a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>deployCR</p></td>
<td><p>bool</p></td>
<td><p><cite>false</cite></p></td>
<td><p>Deploy <code class="docutils literal notranslate"><span class="pre">NicClusterPolicy</span></code> custom resource according to the provided parameters.</p></td>
</tr>
<tr class="row-odd"><td><p>imagePullSecrets</p></td>
<td><p>list</p></td>
<td><p><cite>[]</cite></p></td>
<td><p>An optional list of references to secrets to use for pulling any of the Network Operator images.</p></td>
</tr>
<tr class="row-even"><td><p>nfd.deployNodeFeatureRules</p></td>
<td><p>bool</p></td>
<td><p><cite>true</cite></p></td>
<td><p>Deploy Node Feature Rules to label the nodes with the discovered features.</p></td>
</tr>
<tr class="row-odd"><td><p>nfd.enabled</p></td>
<td><p>bool</p></td>
<td><p><cite>true</cite></p></td>
<td><p>Deploy Node Feature Discovery operator.</p></td>
</tr>
<tr class="row-even"><td><p>operator.admissionController.enabled</p></td>
<td><p>bool</p></td>
<td><p><cite>false</cite></p></td>
<td><p>Deploy with admission controller.</p></td>
</tr>
<tr class="row-odd"><td><p>operator.admissionController.useCertManager</p></td>
<td><p>bool</p></td>
<td><p><cite>true</cite></p></td>
<td><p>Use cert-manager for generating self-signed certificate.</p></td>
</tr>
<tr class="row-even"><td><p>operator.affinity.nodeAffinity</p></td>
<td><p>object</p></td>
<td><p><cite>{“preferredDuringSchedulingIgnoredDuringExecution”:[{“preference”:{“matchExpressions”:[{“key”:”node-role.kubernetes.io/master”,”operator”:”In”,”values”:[“”]}]},”weight”:1},{“preference”:{“matchExpressions”:[{“key”:”node-role.kubernetes.io/control-plane”,”operator”:”In”,”values”:[“”]}]},”weight”:1}]}</cite></p></td>
<td><p>Configure node affinity settings for the operator.</p></td>
</tr>
<tr class="row-odd"><td><p>operator.cniBinDirectory</p></td>
<td><p>string</p></td>
<td><p><cite>“/opt/cni/bin”</cite></p></td>
<td><p>Directory, where CNI binaries will be deployed on the nodes. Setting for  the sriov-network-operator is set with <code class="docutils literal notranslate"><span class="pre">sriov-network-operator.cniBinPath</span></code> parameter. Note that the CNI bin directory should be aligned with the CNI bin directory in the container runtime.</p></td>
</tr>
<tr class="row-even"><td><p>operator.fullnameOverride</p></td>
<td><p>string</p></td>
<td><p><cite>“”</cite></p></td>
<td><p>Name to be used to replace generated names.</p></td>
</tr>
<tr class="row-odd"><td><p>operator.image</p></td>
<td><p>string</p></td>
<td><p><cite>“network-operator”</cite></p></td>
<td><p>Network Operator image name</p></td>
</tr>
<tr class="row-even"><td><p>operator.nameOverride</p></td>
<td><p>string</p></td>
<td><p><cite>“”</cite></p></td>
<td><p>Name to be used as part of objects name generation.</p></td>
</tr>
<tr class="row-odd"><td><p>operator.nodeSelector</p></td>
<td><p>object</p></td>
<td><p><cite>{}</cite></p></td>
<td><p>Configure node selector settings for the operator.</p></td>
</tr>
<tr class="row-even"><td><p>operator.repository</p></td>
<td><p>string</p></td>
<td><p><cite>“nvcr.io/nvstaging/mellanox”</cite></p></td>
<td><p>Network Operator image repository.</p></td>
</tr>
<tr class="row-odd"><td><p>operator.resources</p></td>
<td><p>object</p></td>
<td><p><cite>{“limits”:{“cpu”:”500m”,”memory”:”128Mi”},”requests”:{“cpu”:”5m”,”memory”:”64Mi”}}</cite></p></td>
<td><p>Optional <a class="reference external" href="https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/">resource requests and limits</a> for the operator.</p></td>
</tr>
<tr class="row-even"><td><p>operator.tolerations</p></td>
<td><p>list</p></td>
<td><p><cite>[{“effect”:”NoSchedule”,”key”:”node-role.kubernetes.io/master”,”operator”:”Equal”,”value”:””},{“effect”:”NoSchedule”,”key”:”node-role.kubernetes.io/control-plane”,”operator”:”Equal”,”value”:””}]</cite></p></td>
<td><p>Set additional tolerations for various Daemonsets deployed by the operator.</p></td>
</tr>
<tr class="row-odd"><td><p>operator.useDTK</p></td>
<td><p>bool</p></td>
<td><p><cite>true</cite></p></td>
<td><p>Enable the use of Driver ToolKit to compile OFED drivers (OpenShift only).</p></td>
</tr>
<tr class="row-even"><td><p>sriovNetworkOperator.enabled</p></td>
<td><p>bool</p></td>
<td><p><cite>false</cite></p></td>
<td><p>Deploy SR-IOV Network Operator.</p></td>
</tr>
<tr class="row-odd"><td><p>upgradeCRDs</p></td>
<td><p>bool</p></td>
<td><p><cite>true</cite></p></td>
<td><p>Enable CRDs upgrade with helm pre-install and pre-upgrade hooks.</p></td>
</tr>
</tbody>
</table>
<section id="imagepullsecrets-customization">
<h3>ImagePullSecrets customization<a class="headerlink" href="#imagepullsecrets-customization" title="Permalink to this headline"></a></h3>
<p>To provide <cite>imagePullSecrets`</cite> object references, you need to specify them using a following structure:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>imagePullSecrets:
  - image-pull-secret1
  - image-pull-secret2
</pre></div>
</div>
</section>
</section>
<section id="nfd-labels">
<h2>NFD labels<a class="headerlink" href="#nfd-labels" title="Permalink to this headline"></a></h2>
<p>The NFD labels required by the Network Operator and GPU Operator:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Label</p></th>
<th class="head"><p>Location</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>feature.node.kubernetes.io/pci-15b3.present</p></td>
<td><p>Nodes containing NVIDIA Networking hardware</p></td>
</tr>
<tr class="row-odd"><td><p>feature.node.kubernetes.io/pci-10de.present</p></td>
<td><p>Nodes containing NVIDIA GPU hardware</p></td>
</tr>
</tbody>
</table>
</section>
<section id="node-feature-discovery">
<h2>Node Feature Discovery<a class="headerlink" href="#node-feature-discovery" title="Permalink to this headline"></a></h2>
<p>Node Feature Discovery Helm chart customization options can be found <a class="reference external" href="https://github.com/kubernetes-sigs/node-feature-discovery/blob/master/deployment/helm/node-feature-discovery/values.yaml">here</a>. Following is a list of overriden values by NVIDIA Operator Helm Chart:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default in NVIDIA Network Operator</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>node-feature-discovery.enableNodeFeatureApi</p></td>
<td><p>bool</p></td>
<td><p><cite>true</cite></p></td>
<td><p>The Node Feature API enable communication between nfd master and worker through NodeFeature CRs. Otherwise communication is through gRPC.</p></td>
</tr>
<tr class="row-odd"><td><p>node-feature-discovery.featureGates.NodeFeatureAPI</p></td>
<td><p>bool</p></td>
<td><p><cite>true</cite></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>node-feature-discovery.gc.enable</p></td>
<td><p>bool</p></td>
<td><p><cite>true</cite></p></td>
<td><p>Specifies whether the NFD Garbage Collector should be created</p></td>
</tr>
<tr class="row-odd"><td><p>node-feature-discovery.gc.replicaCount</p></td>
<td><p>int</p></td>
<td><p><cite>1</cite></p></td>
<td><p>Specifies the number of replicas for the NFD Garbage Collector</p></td>
</tr>
<tr class="row-even"><td><p>node-feature-discovery.gc.serviceAccount.create</p></td>
<td><p>bool</p></td>
<td><p><cite>false</cite></p></td>
<td><p>disable creation to avoid duplicate serviceaccount creation by master spec above.</p></td>
</tr>
<tr class="row-odd"><td><p>node-feature-discovery.gc.serviceAccount.name</p></td>
<td><p>string</p></td>
<td><p><cite>“node-feature-discovery”</cite></p></td>
<td><p>The name of the service account for garbage collector to use. If not set and create is true, a name is generated using the fullname template and -gc suffix.</p></td>
</tr>
<tr class="row-even"><td><p>node-feature-discovery.master</p></td>
<td><p>object</p></td>
<td><p><cite>{“config”:{“extraLabelNs”:[“nvidia.com”]},”serviceAccount”:{“create”:true,”name”:”node-feature-discovery”}}</cite></p></td>
<td><p>NFD master deployment configuration.</p></td>
</tr>
<tr class="row-odd"><td><p>node-feature-discovery.worker</p></td>
<td><p>object</p></td>
<td><p><cite>{“config”:{“sources”:{“pci”:{“deviceClassWhitelist”:[“0300”,”0302”],”deviceLabelFields”:[“vendor”]}}},”serviceAccount”:{“create”:false,”name”:”node-feature-discovery”},”tolerations”:[{“effect”:”NoSchedule”,”key”:”node-role.kubernetes.io/master”,”operator”:”Exists”},{“effect”:”NoSchedule”,”key”:”node-role.kubernetes.io/control-plane”,”operator”:”Exists”},{“effect”:”NoSchedule”,”key”:”nvidia.com/gpu”,”operator”:”Exists”}]}</cite></p></td>
<td><p>NFD worker daemonset configuration.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="sr-iov-network-operator">
<h2>SR-IOV Network Operator<a class="headerlink" href="#sr-iov-network-operator" title="Permalink to this headline"></a></h2>
<p>SR-IOV Network Operator Helm chart customization options can be found <a class="reference external" href="https://github.com/k8snetworkplumbingwg/sriov-network-operator/blob/master/deployment/sriov-network-operator/README.md">here</a>. Following is a list of overriden values by NVIDIA Operator Helm Chart:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default in NVIDIA Network Operator</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>sriov-network-operator.images.ibSriovCni</p></td>
<td><p>string</p></td>
<td><p><cite>“ghcr.io/k8snetworkplumbingwg/ib-sriov-cni:v1.1.1”</cite></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>sriov-network-operator.images.operator</p></td>
<td><p>string</p></td>
<td><p><cite>“nvcr.io/nvstaging/mellanox/sriov-network-operator:network-operator-24.7.0-beta.4”</cite></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>sriov-network-operator.images.ovsCni</p></td>
<td><p>string</p></td>
<td><p><cite>“ghcr.io/k8snetworkplumbingwg/ovs-cni-plugin:v0.34.0”</cite></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>sriov-network-operator.images.resourcesInjector</p></td>
<td><p>string</p></td>
<td><p><cite>“ghcr.io/k8snetworkplumbingwg/network-resources-injector:8810e6a127366cc1eb829d3f7cb3f866d096946e”</cite></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>sriov-network-operator.images.sriovCni</p></td>
<td><p>string</p></td>
<td><p><cite>“ghcr.io/k8snetworkplumbingwg/sriov-cni:v2.8.0”</cite></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>sriov-network-operator.images.sriovConfigDaemon</p></td>
<td><p>string</p></td>
<td><p><cite>“nvcr.io/nvstaging/mellanox/sriov-network-operator-config-daemon:network-operator-24.7.0-beta.4”</cite></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>sriov-network-operator.images.sriovDevicePlugin</p></td>
<td><p>string</p></td>
<td><p><cite>“ghcr.io/k8snetworkplumbingwg/sriov-network-device-plugin:v3.7.0”</cite></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>sriov-network-operator.images.webhook</p></td>
<td><p>string</p></td>
<td><p><cite>“nvcr.io/nvstaging/mellanox/sriov-network-operator-webhook:network-operator-24.7.0-beta.4”</cite></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>sriov-network-operator.operator.admissionControllers</p></td>
<td><p>object</p></td>
<td><p><cite>{“certificates”:{“certManager”:{“enabled”:true,”generateSelfSigned”:true},”custom”:{“enabled”:false},”secretNames”:{“injector”:”network-resources-injector-cert”,”operator”:”operator-webhook-cert”}},”enabled”:false}</cite></p></td>
<td><p>Enable admission controller.</p></td>
</tr>
<tr class="row-odd"><td><p>sriov-network-operator.operator.admissionControllers.certificates.certManager.enabled</p></td>
<td><p>bool</p></td>
<td><p><cite>true</cite></p></td>
<td><p>When enabled, makes use of certificates managed by cert-manager.</p></td>
</tr>
<tr class="row-even"><td><p>sriov-network-operator.operator.admissionControllers.certificates.certManager.generateSelfSigned</p></td>
<td><p>bool</p></td>
<td><p><cite>true</cite></p></td>
<td><p>When enabled, certificates are generated via cert-manager and then name will match the name of the secrets defined above.</p></td>
</tr>
<tr class="row-odd"><td><p>sriov-network-operator.operator.admissionControllers.certificates.custom</p></td>
<td><p>object</p></td>
<td><p><cite>{“enabled”:false}</cite></p></td>
<td><p>If not specified, no secret is created and secrets with the names defined above are expected to exist in the cluster. In that case, the ca.crt must be base64 encoded twice since it ends up being an env variable.</p></td>
</tr>
<tr class="row-even"><td><p>sriov-network-operator.operator.resourcePrefix</p></td>
<td><p>string</p></td>
<td><p><cite>“nvidia.com”</cite></p></td>
<td><p>Prefix to be used for resources names.</p></td>
</tr>
<tr class="row-odd"><td><p>sriov-network-operator.sriovOperatorConfig.configDaemonNodeSelector</p></td>
<td><p>object</p></td>
<td><p><cite>{“beta.kubernetes.io/os”:”linux”,”network.nvidia.com/operator.mofed.wait”:”false”}</cite></p></td>
<td><p>Selects the nodes to be configured</p></td>
</tr>
<tr class="row-even"><td><p>sriov-network-operator.sriovOperatorConfig.deploy</p></td>
<td><p>bool</p></td>
<td><p><cite>true</cite></p></td>
<td><p>Deploy <code class="docutils literal notranslate"><span class="pre">SriovOperatorConfig</span></code> custom resource</p></td>
</tr>
</tbody>
</table>
</section>
<section id="container-resources">
<h2>Container Resources<a class="headerlink" href="#container-resources" title="Permalink to this headline"></a></h2>
<p>Optional <a class="reference external" href="https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/">requests and limits</a> can be configured for each container of the sub-resources deployed by the Network Operator by setting the parameter <code class="docutils literal notranslate"><span class="pre">containerResources</span></code>.</p>
<p>For example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">containerResources</span><span class="p">:</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mofed-container&quot;</span><span class="w"></span>
<span class="w">  </span><span class="nt">requests</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;200m&quot;</span><span class="w"></span>
<span class="w">    </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;150Mi&quot;</span><span class="w"></span>
<span class="w">  </span><span class="nt">limits</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;300m&quot;</span><span class="w"></span>
<span class="w">    </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;300Mi&quot;</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="nvidia-doca-driver">
<h2>NVIDIA DOCA Driver<a class="headerlink" href="#nvidia-doca-driver" title="Permalink to this headline"></a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ofedDriver.certConfig.name</p></td>
<td><p>string</p></td>
<td><p><cite>“”</cite></p></td>
<td><p>Custom TLS key/certificate configuration configMap name.</p></td>
</tr>
<tr class="row-odd"><td><p>ofedDriver.deploy</p></td>
<td><p>bool</p></td>
<td><p><cite>false</cite></p></td>
<td><p>Deploy the  NVIDIA DOCA Driver driver container.</p></td>
</tr>
<tr class="row-even"><td><p>ofedDriver.forcePrecompiled</p></td>
<td><p>bool</p></td>
<td><p><cite>false</cite></p></td>
<td><p>Fail Mellanox OFED deployment if precompiled OFED driver container image does not exists.</p></td>
</tr>
<tr class="row-odd"><td><p>ofedDriver.image</p></td>
<td><p>string</p></td>
<td><p><cite>“doca-driver”</cite></p></td>
<td><p>NVIDIA DOCA Driver image name.</p></td>
</tr>
<tr class="row-even"><td><p>ofedDriver.initContainer.enable</p></td>
<td><p>bool</p></td>
<td><p><cite>true</cite></p></td>
<td><p>Deploy init container.</p></td>
</tr>
<tr class="row-odd"><td><p>ofedDriver.initContainer.image</p></td>
<td><p>string</p></td>
<td><p><cite>“network-operator-init-container”</cite></p></td>
<td><p>Init container image name.</p></td>
</tr>
<tr class="row-even"><td><p>ofedDriver.initContainer.repository</p></td>
<td><p>string</p></td>
<td><p><cite>“ghcr.io/mellanox”</cite></p></td>
<td><p>Init container image repository.</p></td>
</tr>
<tr class="row-odd"><td><p>ofedDriver.initContainer.version</p></td>
<td><p>string</p></td>
<td><p><cite>“v0.0.2”</cite></p></td>
<td><p>Init container image version.</p></td>
</tr>
<tr class="row-even"><td><p>ofedDriver.livenessProbe.initialDelaySeconds</p></td>
<td><p>int</p></td>
<td><p><cite>30</cite></p></td>
<td><p>NVIDIA DOCA Driver liveness probe initial delay.</p></td>
</tr>
<tr class="row-odd"><td><p>ofedDriver.livenessProbe.periodSeconds</p></td>
<td><p>int</p></td>
<td><p><cite>30</cite></p></td>
<td><p>NVIDIA DOCA Driver liveness probe interval.</p></td>
</tr>
<tr class="row-even"><td><p>ofedDriver.readinessProbe.initialDelaySeconds</p></td>
<td><p>int</p></td>
<td><p><cite>10</cite></p></td>
<td><p>NVIDIA DOCA Driver readiness probe initial delay.</p></td>
</tr>
<tr class="row-odd"><td><p>ofedDriver.readinessProbe.periodSeconds</p></td>
<td><p>int</p></td>
<td><p><cite>30</cite></p></td>
<td><p>NVIDIA DOCA Driver readiness probe interval.</p></td>
</tr>
<tr class="row-even"><td><p>ofedDriver.repoConfig</p></td>
<td><p>object</p></td>
<td><p><cite>{“name”:””}</cite></p></td>
<td><p>Private mirror repository configuration.</p></td>
</tr>
<tr class="row-odd"><td><p>ofedDriver.repository</p></td>
<td><p>string</p></td>
<td><p><cite>“nvcr.io/nvstaging/mellanox”</cite></p></td>
<td><p>NVIDIA DOCA Driver image repository.</p></td>
</tr>
<tr class="row-even"><td><p>ofedDriver.startupProbe.initialDelaySeconds</p></td>
<td><p>int</p></td>
<td><p><cite>10</cite></p></td>
<td><p>NVIDIA DOCA Driver startup probe initial delay.</p></td>
</tr>
<tr class="row-odd"><td><p>ofedDriver.startupProbe.periodSeconds</p></td>
<td><p>int</p></td>
<td><p><cite>20</cite></p></td>
<td><p>NVIDIA DOCA Driver startup probe interval.</p></td>
</tr>
<tr class="row-even"><td><p>ofedDriver.terminationGracePeriodSeconds</p></td>
<td><p>int</p></td>
<td><p><cite>300</cite></p></td>
<td><p>The grace period before the driver containeris forcibly removed.</p></td>
</tr>
<tr class="row-odd"><td><p>ofedDriver.upgradePolicy.autoUpgrade</p></td>
<td><p>bool</p></td>
<td><p><cite>true</cite></p></td>
<td><p>Global switch for automatic upgrade feature, if set to false all other options are ignored.</p></td>
</tr>
<tr class="row-even"><td><p>ofedDriver.upgradePolicy.drain</p></td>
<td><p>object</p></td>
<td><p><cite>{“deleteEmptyDir”:true,”enable”:true,”force”:true,”podSelector”:””,”timeoutSeconds”:300}</cite></p></td>
<td><p>Options for node drain (<cite>kubectl drain</cite>) before the driver reload. If auto upgrade is enabled but drain.enable is false, then driver POD will be reloaded immediately without removing PODs from the node.</p></td>
</tr>
<tr class="row-odd"><td><p>ofedDriver.upgradePolicy.drain.deleteEmptyDir</p></td>
<td><p>bool</p></td>
<td><p><cite>true</cite></p></td>
<td><p>Delete pods local storage.</p></td>
</tr>
<tr class="row-even"><td><p>ofedDriver.upgradePolicy.drain.enable</p></td>
<td><p>bool</p></td>
<td><p><cite>true</cite></p></td>
<td><p>Options for node drain (<code class="docutils literal notranslate"><span class="pre">kubectl</span> <span class="pre">drain</span></code>) before driver reload, if auto upgrade is enabled.</p></td>
</tr>
<tr class="row-odd"><td><p>ofedDriver.upgradePolicy.drain.force</p></td>
<td><p>bool</p></td>
<td><p><cite>true</cite></p></td>
<td><p>Use force drain of pods.</p></td>
</tr>
<tr class="row-even"><td><p>ofedDriver.upgradePolicy.drain.podSelector</p></td>
<td><p>string</p></td>
<td><p><cite>“”</cite></p></td>
<td><p>Pod selector to specify which pods will be drained from the node. An empty selector means all pods.</p></td>
</tr>
<tr class="row-odd"><td><p>ofedDriver.upgradePolicy.drain.timeoutSeconds</p></td>
<td><p>int</p></td>
<td><p><cite>300</cite></p></td>
<td><p>It’s recommended to set a timeout to avoid infinite drain in case non-fatal error keeps happening on retries.</p></td>
</tr>
<tr class="row-even"><td><p>ofedDriver.upgradePolicy.maxParallelUpgrades</p></td>
<td><p>int</p></td>
<td><p><cite>1</cite></p></td>
<td><p>Number of nodes that can be upgraded in parallel (default: 1). 0 means no limit, all nodes will be upgraded in parallel.</p></td>
</tr>
<tr class="row-odd"><td><p>ofedDriver.upgradePolicy.safeLoad</p></td>
<td><p>bool</p></td>
<td><p><cite>false</cite></p></td>
<td><p>Cordon and drain (if enabled) a node before loading the driver on it.</p></td>
</tr>
<tr class="row-even"><td><p>ofedDriver.upgradePolicy.waitForCompletion</p></td>
<td><p>string</p></td>
<td><p><cite>nil</cite></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ofedDriver.version</p></td>
<td><p>string</p></td>
<td><p><cite>“24.07-0.6.0.0-1”</cite></p></td>
<td><p>NVIDIA DOCA Driver version.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="nvidia-doca-driver-driver-environment-variables">
<h2>NVIDIA DOCA Driver Driver Environment Variables<a class="headerlink" href="#nvidia-doca-driver-driver-environment-variables" title="Permalink to this headline"></a></h2>
<p>The following are special environment variables supported by the NVIDIA DOCA Driver container to configure its behavior:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CREATE_IFNAMES_UDEV</p></td>
<td><div class="line-block">
<div class="line">* “true” for Ubuntu 20.04, RHEL v8.x and OCP &lt;= v4.13.</div>
<div class="line">* “false” for newer OS.</div>
</div>
</td>
<td><p>Create an udev rule to preserve “old-style” path based netdev names e.g enp3s0f0</p></td>
</tr>
<tr class="row-odd"><td><p>UNLOAD_STORAGE_MODULES</p></td>
<td><p>“false”</p></td>
<td><div class="line-block">
<div class="line">Unload host storage modules prior to loading NVIDIA DOCA Driver modules:</div>
<div class="line-block">
<div class="line">* ib_isert</div>
<div class="line">* nvme_rdma</div>
<div class="line">* nvmet_rdma</div>
<div class="line">* rpcrdma</div>
<div class="line">* xprtrdma</div>
<div class="line">* ib_srpt</div>
</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>ENABLE_NFSRDMA</p></td>
<td><p>“false”</p></td>
<td><p>Enable loading of NFS &amp; NVME related storage modules from a NVIDIA DOCA Driver container</p></td>
</tr>
<tr class="row-odd"><td><p>RESTORE_DRIVER_ON_POD_TERMINATION</p></td>
<td><p>“true”</p></td>
<td><p>Restore host drivers when a container</p></td>
</tr>
</tbody>
</table>
<p>In addition, it is possible to specify any environment variables to be exposed to the NVIDIA DOCA Driver container, such as the standard “HTTP_PROXY”, “HTTPS_PROXY”, “NO_PROXY”.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>CREATE_IFNAMES_UDEV is set automatically by the Network Operator, depending on the Operating System of the worker nodes in the cluster (the cluster is assumed to be homogenous).</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When ENABLE_NFSRDMA is set to <cite>true</cite>, it is not possible to load NVME related storage modules from NVIDIA DOCA Driver container when they are in use by the system
(e.g the system has NVMe SSD drives in use). User should ensure the modules are not in use and blacklist them prior to the use of NVIDIA DOCA Driver container.</p>
</div>
<p>To set these variables, change them into Helm values. For example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ofedDriver</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">env</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RESTORE_DRIVER_ON_POD_TERMINATION</span><span class="w"></span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;true&quot;</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">UNLOAD_STORAGE_MODULES</span><span class="w"></span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;true&quot;</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CREATE_IFNAMES_UDEV</span><span class="w"></span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;true&quot;</span><span class="w"></span>
</pre></div>
</div>
<p>The variables can also be configured directly via the NicClusterPolicy CRD.</p>
</section>
<section id="rdma-shared-device-plugin">
<h2>RDMA Shared Device Plugin<a class="headerlink" href="#rdma-shared-device-plugin" title="Permalink to this headline"></a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>rdmaSharedDevicePlugin.deploy</p></td>
<td><p>bool</p></td>
<td><p><cite>true</cite></p></td>
<td><p>Deploy RDMA shared device plugin.</p></td>
</tr>
<tr class="row-odd"><td><p>rdmaSharedDevicePlugin.image</p></td>
<td><p>string</p></td>
<td><p><cite>“k8s-rdma-shared-dev-plugin”</cite></p></td>
<td><p>RDMA shared device plugin image name.</p></td>
</tr>
<tr class="row-even"><td><p>rdmaSharedDevicePlugin.repository</p></td>
<td><p>string</p></td>
<td><p><cite>“ghcr.io/mellanox”</cite></p></td>
<td><p>RDMA shared device plugin image repository.</p></td>
</tr>
<tr class="row-odd"><td><p>rdmaSharedDevicePlugin.resources</p></td>
<td><p>list</p></td>
<td><p><cite>[{“name”:”rdma_shared_device_a”,”rdmaHcaMax”:63,”vendors”:[“15b3”]}]</cite></p></td>
<td><p>The following defines the RDMA resources in the cluster. It must be provided by the user when deploying the chart. Each entry in the resources element will create a resource with the provided &lt;name&gt; and list of devices.</p></td>
</tr>
<tr class="row-even"><td><p>rdmaSharedDevicePlugin.useCdi</p></td>
<td><p>bool</p></td>
<td><p><cite>false</cite></p></td>
<td><p>Enable Container Device Interface (CDI) mode. <strong>NOTE</strong>: NVIDIA Network Operator does not configure container runtime to enable CDI.</p></td>
</tr>
<tr class="row-odd"><td><p>rdmaSharedDevicePlugin.version</p></td>
<td><p>string</p></td>
<td><p><cite>“v1.5.1”</cite></p></td>
<td><p>RDMA shared device plugin version.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="rdma-device-plugin-resource-configurations">
<h2>RDMA Device Plugin Resource Configurations<a class="headerlink" href="#rdma-device-plugin-resource-configurations" title="Permalink to this headline"></a></h2>
<p>These configurations consist of a list of RDMA resources, each with a name and a selector of RDMA capable network devices to be associated with the resource. Refer to <a class="reference external" href="https://github.com/Mellanox/k8s-rdma-shared-dev-plugin#devices-selectors">RDMA Shared Device Plugin Selectors</a> for supported selectors.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">resources</span><span class="p">:</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rdma_shared_device_a</span><span class="w"></span>
<span class="w">  </span><span class="nt">vendors</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">15b3</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="w">  </span><span class="nt">deviceIDs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1017</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="w">  </span><span class="nt">ifNames</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">enp5s0f0</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="w">  </span><span class="nt">rdmaHcaMax</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">63</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rdma_shared_device_b</span><span class="w"></span>
<span class="w">  </span><span class="nt">vendors</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">15b3</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="w">  </span><span class="nt">deviceIDs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1017</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="w">  </span><span class="nt">ifNames</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">ib0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">ib1</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="w">  </span><span class="nt">rdmaHcaMax</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">63</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="sr-iov-network-device-plugin">
<h2>SR-IOV Network Device Plugin<a class="headerlink" href="#sr-iov-network-device-plugin" title="Permalink to this headline"></a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>sriovDevicePlugin.deploy</p></td>
<td><p>bool</p></td>
<td><p><cite>false</cite></p></td>
<td><p>Deploy SR-IOV Network device plugin.</p></td>
</tr>
<tr class="row-odd"><td><p>sriovDevicePlugin.image</p></td>
<td><p>string</p></td>
<td><p><cite>“sriov-network-device-plugin”</cite></p></td>
<td><p>SR-IOV Network device plugin image name.</p></td>
</tr>
<tr class="row-even"><td><p>sriovDevicePlugin.repository</p></td>
<td><p>string</p></td>
<td><p><cite>“ghcr.io/k8snetworkplumbingwg”</cite></p></td>
<td><p>SR-IOV Network device plugin image repository.</p></td>
</tr>
<tr class="row-odd"><td><p>sriovDevicePlugin.resources[0].name</p></td>
<td><p>string</p></td>
<td><p><cite>“hostdev”</cite></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>sriovDevicePlugin.resources[0].vendors[0]</p></td>
<td><p>string</p></td>
<td><p><cite>“15b3”</cite></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>sriovDevicePlugin.useCdi</p></td>
<td><p>bool</p></td>
<td><p><cite>false</cite></p></td>
<td><p>Enable Container Device Interface (CDI) mode. <strong>NOTE</strong>: NVIDIA Network Operator does not configure container runtime to enable CD.</p></td>
</tr>
<tr class="row-even"><td><p>sriovDevicePlugin.version</p></td>
<td><p>string</p></td>
<td><p><cite>“v3.7.0”</cite></p></td>
<td><p>SR-IOV Network device plugin version</p></td>
</tr>
</tbody>
</table>
</section>
<section id="sr-iov-network-device-plugin-resource-configuration">
<h2>SR-IOV Network Device Plugin Resource Configuration<a class="headerlink" href="#sr-iov-network-device-plugin-resource-configuration" title="Permalink to this headline"></a></h2>
<p>Consists of a list of RDMA resources, each with a name and a selector of RDMA capable network devices to be associated with the resource. Refer to <a class="reference external" href="https://github.com/k8snetworkplumbingwg/sriov-network-device-plugin#device-selectors">SR-IOV Network Device Plugin Selectors</a> for supported selectors.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">resources</span><span class="p">:</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hostdev</span><span class="w"></span>
<span class="w">  </span><span class="nt">vendors</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">15b3</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ethernet_rdma</span><span class="w"></span>
<span class="w">  </span><span class="nt">vendors</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">15b3</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="w">  </span><span class="nt">linkTypes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">ether</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sriov_rdma</span><span class="w"></span>
<span class="w">  </span><span class="nt">vendors</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">15b3</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="w">  </span><span class="nt">devices</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1018</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="w">  </span><span class="nt">drivers</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">mlx5_ib</span><span class="p p-Indicator">]</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="ib-kubernetes">
<h2>IB Kubernetes<a class="headerlink" href="#ib-kubernetes" title="Permalink to this headline"></a></h2>
<p>ib-kubernetes provides a daemon that works in conjunction with the <a class="reference external" href="https://github.com/openshift/sriov-network-operator">SR-IOV Network Device Plugin</a>. It acts on Kubernetes pod object changes (Create/Update/Delete), reading the pod’s network annotation, fetching its corresponding network CRD and reading the PKey. This is done in order to add the newly generated GUID or the predefined GUID in the GUID field of the CRD cni-args to that PKey for pods with <code class="docutils literal notranslate"><span class="pre">mellanox.infiniband.app</span></code> annotation.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ibKubernetes.deploy</p></td>
<td><p>bool</p></td>
<td><p><cite>false</cite></p></td>
<td><p>Deploy IB Kubernetes.</p></td>
</tr>
<tr class="row-odd"><td><p>ibKubernetes.image</p></td>
<td><p>string</p></td>
<td><p><cite>“ib-kubernetes”</cite></p></td>
<td><p>IB Kubernetes image name.</p></td>
</tr>
<tr class="row-even"><td><p>ibKubernetes.pKeyGUIDPoolRangeEnd</p></td>
<td><p>string</p></td>
<td><p><cite>“02:FF:FF:FF:FF:FF:FF:FF”</cite></p></td>
<td><p>Maximal available GUID value to be allocated for the pod.</p></td>
</tr>
<tr class="row-odd"><td><p>ibKubernetes.pKeyGUIDPoolRangeStart</p></td>
<td><p>string</p></td>
<td><p><cite>“02:00:00:00:00:00:00:00”</cite></p></td>
<td><p>Minimal available GUID value to be allocated for the pod.</p></td>
</tr>
<tr class="row-even"><td><p>ibKubernetes.periodicUpdateSeconds</p></td>
<td><p>int</p></td>
<td><p><cite>5</cite></p></td>
<td><p>Interval of periodic update in seconds.</p></td>
</tr>
<tr class="row-odd"><td><p>ibKubernetes.repository</p></td>
<td><p>string</p></td>
<td><p><cite>“ghcr.io/mellanox”</cite></p></td>
<td><p>IB Kubernetes image repository.</p></td>
</tr>
<tr class="row-even"><td><p>ibKubernetes.ufmSecret</p></td>
<td><p>string</p></td>
<td><p><cite>“”</cite></p></td>
<td><p>Name of the Secret with the NVIDIA UFM access credentials, deployed in advance.</p></td>
</tr>
<tr class="row-odd"><td><p>ibKubernetes.version</p></td>
<td><p>string</p></td>
<td><p><cite>“v1.0.2”</cite></p></td>
<td><p>IB Kubernetes version.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="ufm-secret">
<h2>UFM Secret<a class="headerlink" href="#ufm-secret" title="Permalink to this headline"></a></h2>
<p>IB Kubernetes must access <a class="reference external" href="https://www.nvidia.com/en-us/networking/infiniband/ufm/">NVIDIA UFM</a> in order to manage pods’ GUIDs. To provide its credentials, the secret of the following format should be deployed in advance:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span><span class="w"></span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Secret</span><span class="w"></span>
<span class="nt">metadata</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ib-kubernetes-ufm-secret</span><span class="w"></span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nvidia-network-operator</span><span class="w"></span>
<span class="nt">stringData</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">UFM_USERNAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;admin&quot;</span><span class="w"></span>
<span class="w">  </span><span class="nt">UFM_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;123456&quot;</span><span class="w"></span>
<span class="w">  </span><span class="nt">UFM_ADDRESS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ufm-hostname&quot;</span><span class="w"></span>
<span class="w">  </span><span class="nt">UFM_HTTP_SCHEMA</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"></span>
<span class="w">  </span><span class="nt">UFM_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"></span>
<span class="nt">data</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">UFM_CERTIFICATE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"></span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The InfiniBand Fabric manages a single pool of GUIDs. In order to use IB Kubernetes in different clusters, different GUID ranges must be specified to avoid collisions.</p>
</div>
</section>
<section id="nvidia-ipam-plugin">
<h2>NVIDIA IPAM Plugin<a class="headerlink" href="#nvidia-ipam-plugin" title="Permalink to this headline"></a></h2>
<p><a class="reference external" href="https://github.com/Mellanox/nvidia-k8s-ipam">NVIDIA IPAM Plugin</a> is recommended to be used on large-scale deployments of the NVIDIA Network Operator.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>nvIpam.deploy</p></td>
<td><p>bool</p></td>
<td><p><cite>true</cite></p></td>
<td><p>Deploy NVIDIA IPAM Plugin.</p></td>
</tr>
<tr class="row-odd"><td><p>nvIpam.enableWebhook</p></td>
<td><p>bool</p></td>
<td><p><cite>false</cite></p></td>
<td><p>Enable deployment of the validataion webhook for IPPool CRD.</p></td>
</tr>
<tr class="row-even"><td><p>nvIpam.image</p></td>
<td><p>string</p></td>
<td><p><cite>“nvidia-k8s-ipam”</cite></p></td>
<td><p>NVIDIA IPAM Plugin image name.</p></td>
</tr>
<tr class="row-odd"><td><p>nvIpam.repository</p></td>
<td><p>string</p></td>
<td><p><cite>“ghcr.io/mellanox”</cite></p></td>
<td><p>NVIDIA IPAM Plugin image repository.</p></td>
</tr>
<tr class="row-even"><td><p>nvIpam.version</p></td>
<td><p>string</p></td>
<td><p><cite>“v0.2.0”</cite></p></td>
<td><p>NVIDIA IPAM Plugin image version.</p></td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Supported X.509 certificate management system should be available in the cluster to enable the validation webhook. Currently, the supported systems are <a class="reference external" href="https://cert-manager.io/">certmanager</a> and <a class="reference external" href="https://docs.openshift.com/container-platform/latest/security/certificates/service-serving-certificate.html">Openshift certificate management</a>.</p>
</div>
</section>
<section id="secondary-network">
<h2>Secondary Network<a class="headerlink" href="#secondary-network" title="Permalink to this headline"></a></h2>
<p>Specifies components to deploy in order to facilitate a secondary network in Kubernetes. It consists of the following optionally deployed components:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/k8snetworkplumbingwg/multus-cni">Multus-CNI</a>: Delegate CNI plugin to support secondary networks in Kubernetes</p></li>
<li><p>CNI plugins: Currently only <a class="reference external" href="https://github.com/containernetworking/plugins">containernetworking-plugins</a> is supported</p></li>
<li><p>IPAM CNI: Currently only <a class="reference external" href="https://github.com/k8snetworkplumbingwg/whereabouts">Whereabout IPAM CNI</a> is supported as a part of the secondaryNetwork section. NVIDIA-IPAM is configured separately.</p></li>
<li><p><a class="reference external" href="https://github.com/Mellanox/ipoib-cni">IPoIB CNI</a>: Allows the user to create IPoIB child link and move it to the pod</p></li>
</ul>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>secondaryNetwork.cniPlugins.deploy</p></td>
<td><p>bool</p></td>
<td><p><cite>true</cite></p></td>
<td><p>Deploy CNI Plugins Secondary Network.</p></td>
</tr>
<tr class="row-odd"><td><p>secondaryNetwork.cniPlugins.image</p></td>
<td><p>string</p></td>
<td><p><cite>“plugins”</cite></p></td>
<td><p>CNI Plugins image name.</p></td>
</tr>
<tr class="row-even"><td><p>secondaryNetwork.cniPlugins.repository</p></td>
<td><p>string</p></td>
<td><p><cite>“ghcr.io/k8snetworkplumbingwg”</cite></p></td>
<td><p>CNI Plugins image repository.</p></td>
</tr>
<tr class="row-odd"><td><p>secondaryNetwork.cniPlugins.version</p></td>
<td><p>string</p></td>
<td><p><cite>“v1.5.0”</cite></p></td>
<td><p>CNI Plugins image version.</p></td>
</tr>
<tr class="row-even"><td><p>secondaryNetwork.deploy</p></td>
<td><p>bool</p></td>
<td><p><cite>true</cite></p></td>
<td><p>Deploy Secondary Network.</p></td>
</tr>
<tr class="row-odd"><td><p>secondaryNetwork.ipamPlugin.deploy</p></td>
<td><p>bool</p></td>
<td><p><cite>false</cite></p></td>
<td><p>Deploy IPAM CNI Plugin Secondary Network.</p></td>
</tr>
<tr class="row-even"><td><p>secondaryNetwork.ipamPlugin.image</p></td>
<td><p>string</p></td>
<td><p><cite>“whereabouts”</cite></p></td>
<td><p>IPAM CNI Plugin image name.</p></td>
</tr>
<tr class="row-odd"><td><p>secondaryNetwork.ipamPlugin.repository</p></td>
<td><p>string</p></td>
<td><p><cite>“ghcr.io/k8snetworkplumbingwg”</cite></p></td>
<td><p>IPAM CNI Plugin image repository.</p></td>
</tr>
<tr class="row-even"><td><p>secondaryNetwork.ipamPlugin.version</p></td>
<td><p>string</p></td>
<td><p><cite>“v0.7.0”</cite></p></td>
<td><p>IPAM CNI Plugin image version.</p></td>
</tr>
<tr class="row-odd"><td><p>secondaryNetwork.ipoib.deploy</p></td>
<td><p>bool</p></td>
<td><p><cite>false</cite></p></td>
<td><p>Deploy IPoIB CNI.</p></td>
</tr>
<tr class="row-even"><td><p>secondaryNetwork.ipoib.image</p></td>
<td><p>string</p></td>
<td><p><cite>“ipoib-cni”</cite></p></td>
<td><p>IPoIB CNI image name.</p></td>
</tr>
<tr class="row-odd"><td><p>secondaryNetwork.ipoib.repository</p></td>
<td><p>string</p></td>
<td><p><cite>“ghcr.io/mellanox”</cite></p></td>
<td><p>IPoIB CNI image repository.</p></td>
</tr>
<tr class="row-even"><td><p>secondaryNetwork.ipoib.version</p></td>
<td><p>string</p></td>
<td><p><cite>“v1.2.0”</cite></p></td>
<td><p>IPoIB CNI image version.</p></td>
</tr>
<tr class="row-odd"><td><p>secondaryNetwork.multus.deploy</p></td>
<td><p>bool</p></td>
<td><p><cite>true</cite></p></td>
<td><p>Deploy Multus Secondary Network.</p></td>
</tr>
<tr class="row-even"><td><p>secondaryNetwork.multus.image</p></td>
<td><p>string</p></td>
<td><p><cite>“multus-cni”</cite></p></td>
<td><p>Multus image name.</p></td>
</tr>
<tr class="row-odd"><td><p>secondaryNetwork.multus.repository</p></td>
<td><p>string</p></td>
<td><p><cite>“ghcr.io/k8snetworkplumbingwg”</cite></p></td>
<td><p>Multus image repository.</p></td>
</tr>
<tr class="row-even"><td><p>secondaryNetwork.multus.version</p></td>
<td><p>string</p></td>
<td><p><cite>“v3.9.3”</cite></p></td>
<td><p>Multus image version.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="nvidia-nic-feature-discovery">
<h2>NVIDIA NIC Feature Discovery<a class="headerlink" href="#nvidia-nic-feature-discovery" title="Permalink to this headline"></a></h2>
<p><a class="reference external" href="https://github.com/Mellanox/nic-feature-discovery">NVIDIA NIC Feature Discovery</a> leverages <a class="reference external" href="https://kubernetes-sigs.github.io/node-feature-discovery/stable/get-started/index.html">Node Feature Discovery</a> to advertise NIC specific labels on K8s Node objects.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>nicFeatureDiscovery.deploy</p></td>
<td><p>bool</p></td>
<td><p><cite>false</cite></p></td>
<td><p>Deploy NVIDIA NIC Feature Discovery.</p></td>
</tr>
<tr class="row-odd"><td><p>nicFeatureDiscovery.image</p></td>
<td><p>string</p></td>
<td><p><cite>“nic-feature-discovery”</cite></p></td>
<td><p>NVIDIA NIC Feature Discovery image name.</p></td>
</tr>
<tr class="row-even"><td><p>nicFeatureDiscovery.repository</p></td>
<td><p>string</p></td>
<td><p><cite>“ghcr.io/mellanox”</cite></p></td>
<td><p>NVIDIA NIC Feature Discovery repository.</p></td>
</tr>
<tr class="row-odd"><td><p>nicFeatureDiscovery.version</p></td>
<td><p>string</p></td>
<td><p><cite>“v0.0.1”</cite></p></td>
<td><p>NVIDIA NIC Feature Discovery image version.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="doca-telemetry-service">
<h2>DOCA Telemetry Service<a class="headerlink" href="#doca-telemetry-service" title="Permalink to this headline"></a></h2>
<p><a class="reference external" href="https://catalog.ngc.nvidia.com/orgs/nvidia/teams/doca/containers/doca_telemetry">DOCA Telemetry Service</a> exports metrics from NVIDIA NICs on K8s Nodes.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>docaTelemetryService.deploy</p></td>
<td><p>bool</p></td>
<td><p><cite>false</cite></p></td>
<td><p>Deploy DOCA Telemetry Service.</p></td>
</tr>
<tr class="row-odd"><td><p>docaTelemetryService.image</p></td>
<td><p>string</p></td>
<td><p><cite>“doca_telemetry”</cite></p></td>
<td><p>DOCA Telemetry Service image name.</p></td>
</tr>
<tr class="row-even"><td><p>docaTelemetryService.repository</p></td>
<td><p>string</p></td>
<td><p><cite>“nvcr.io/nvidia/doca”</cite></p></td>
<td><p>DOCA Telemetry Service image repository.</p></td>
</tr>
<tr class="row-odd"><td><p>docaTelemetryService.version</p></td>
<td><p>string</p></td>
<td><p><cite>“1.16.5-doca2.6.0-host”</cite></p></td>
<td><p>DOCA Telemetry Service image version.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="helm-customization-file">
<h2>Helm customization file<a class="headerlink" href="#helm-customization-file" title="Permalink to this headline"></a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Since several parameters should be provided when creating custom resources during operator deployment, it is recommended to use a configuration file. While it is possible to override the parameters via CLI, we recommend to avoid the use of CLI arguments in favor of a configuration file.</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ helm install -f ./values.yaml -n nvidia-network-operator --create-namespace --wait nvidia/network-operator network-operator
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, NVIDIA.
      <span class="lastupdated">Last updated on Aug 22, 2024.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 



</body>
</html>